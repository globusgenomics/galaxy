<tool id="hist_high_quality_score" name="Histogram" version="RPY: default">
<description> of high quality score reads </description>

<command interpreter="python">short_reads_figure_high_quality_length.py $input1 $output1 $input2</command>

<inputs>
<page>
    <param format="qualsolexa,qual454,txtseq.zip" help="No dataset? Read tip below" label="Quality score file" name="input1" type="data"/>
    <param label="Quality score threshold" name="input2" size="5" type="integer" value="20"/>
</page>
</inputs>
<outputs>
  	<data format="pdf" name="output1"/>
</outputs>
<requirements>
	<requirement type="python-module">rpy</requirement>
</requirements>
<tests>
	<test>
		<param ftype="qualsolexa" name="input1" value="solexa.qual"/>
		<param name="input2" value="5"/>
  		<output file="solexa_high_quality_hist.pdf" ftype="pdf" name="output1"/>
	</test>
	<test>
		<param ftype="qual454" name="input1" value="454.qual"/>
		<param name="input2" value="5"/>
		<output file="454_high_quality_hist.pdf" ftype="pdf" name="output1"/>
	</test>
</tests>

<help>

.. class:: warningmark

To use this tool, your dataset needs to be in the *Quality Score* format. Click the pencil icon next to your dataset to set the datatype to *Quality Score* (see below for examples).

-----

**What it does**

This tool takes Quality Files generated by Roche (454), Illumina (Solexa), or ABI SOLiD machines and builds a histogram of lengths of high quality reads.

-----

**Examples of Quality Data**

Roche (454) or ABI SOLiD data::

	&gt;seq1
	23 33 34 25 28 28 28 32 23 34 27 4 28 28 31 21 28

Illumina (Solexa) data::

 	-40 -40 40 -40	 -40 -40 -40 40	 
 
-----

**Note**

- Quality score data::

	&gt;seq1
	23 33 34 25 28 28 28 32 23 34 27 4 28 28 31 21 28

- If the threshold is set to 20:

  - a low quality score 4 in the middle separated two segments of lengths 11 and 5.

  - The histogram will be built based on the numbers (11, 5).
	 	
- For Illumina (Solexa) data, only the maximal of the 4 values will be used.


</help>
</tool>